<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 4: Quadratic Formula ‚Ä¢ GuyThatLives Network</title>
    <meta name="description" content="Master using the quadratic formula to solve any quadratic equation.">
    
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Crimson+Pro:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://guythatlives.net/math/shared/firebase-auth.js"></script>
    <script src="https://guythatlives.net/math/shared/global-header.js"></script>
    <link rel="stylesheet" href="https://guythatlives.net/math/shared/progress-ui.css">
    <script src="https://guythatlives.net/math/shared/progress-tracker.js"></script>
    <link rel="stylesheet" href="https://guythatlives.net/math/shared/app-panel.css">
    <script src="https://guythatlives.net/math/shared/app-panel.js"></script>
    
    <style>
        :root{--primary:#0a0e27;--accent:#64ffda;--secondary:#1a1f3a;--text:#e1e5f2;--text-dim:#8892b0;--surface:#151932;--border:#233554;--success:#50fa7b;--warning:#f1fa8c;--error:#ff5555}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Crimson Pro',serif;background:var(--primary);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
        .bg-container{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;background:radial-gradient(circle at 20% 80%,rgba(100,255,218,0.1) 0%,transparent 50%),radial-gradient(circle at 80% 20%,rgba(100,255,218,0.05) 0%,transparent 50%),linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%)}
        .grid-overlay{position:absolute;width:100%;height:100%;background-image:linear-gradient(rgba(100,255,218,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(100,255,218,0.03) 1px,transparent 1px);background-size:40px 40px;animation:gridShift 20s linear infinite}
        @keyframes gridShift{0%{transform:translate(0,0)}100%{transform:translate(40px,40px)}}
        .container{max-width:1200px;margin:0 auto;padding:2rem;position:relative;z-index:1}
        header{display:flex;justify-content:space-between;align-items:center;padding:1rem 0 2rem;animation:slideDown 1s ease-out}
        .header-controls{display:flex;align-items:center;gap:1rem}
        .restart-btn{background:transparent;border:2px solid var(--warning);color:var(--warning);font-family:'JetBrains Mono',monospace;font-size:0.8rem;padding:0.5rem 1rem;border-radius:6px;cursor:pointer;transition:all 0.3s ease;white-space:nowrap}
        .restart-btn:hover{background:var(--warning);color:var(--primary)}
        .logo{font-family:'JetBrains Mono',monospace;font-weight:700;font-size:1.2rem;color:var(--accent);text-decoration:none}
        .breadcrumb{font-family:'JetBrains Mono',monospace;font-size:0.8rem;color:var(--text-dim)}
        .breadcrumb a{color:var(--text-dim);text-decoration:none;transition:color 0.3s ease}
        .breadcrumb a:hover{color:var(--accent)}
        .main-content{display:grid;grid-template-columns:1fr 1fr;gap:3rem;animation:slideUp 1s ease-out 0.3s both}
        .problem-section{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:2rem;height:fit-content}
        .problem-header{display:flex;align-items:center;gap:1rem;margin-bottom:2rem}
        .problem-number{background:var(--warning);color:var(--primary);font-family:'JetBrains Mono',monospace;font-weight:700;padding:0.5rem 1rem;border-radius:8px;font-size:0.9rem}
        .problem-title{font-size:1.4rem;font-weight:600}
        .problem-statement{background:rgba(241,250,140,0.05);border:1px solid rgba(241,250,140,0.2);border-radius:12px;padding:2rem;margin-bottom:2rem;text-align:center}
        .equation-display{font-size:2rem;font-weight:500;margin:1rem 0;color:var(--warning)}
        .solve-instruction{font-family:'JetBrains Mono',monospace;font-size:0.9rem;color:var(--text-dim)}
        .input-section{margin-bottom:2rem}
        .input-label{font-family:'JetBrains Mono',monospace;font-size:0.9rem;color:var(--text-dim);margin-bottom:0.5rem;display:block}
        .math-input{width:100%;background:var(--primary);border:2px solid var(--border);color:var(--text);font-family:'JetBrains Mono',monospace;font-size:1.2rem;padding:1rem;border-radius:8px;transition:border-color 0.3s ease}
        .math-input:focus{outline:none;border-color:var(--warning)}
        .submit-btn{width:100%;background:transparent;border:2px solid var(--warning);color:var(--warning);font-family:'JetBrains Mono',monospace;font-weight:500;font-size:1rem;padding:1rem 2rem;border-radius:8px;cursor:pointer;transition:all 0.3s ease;position:relative;overflow:hidden}
        .submit-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:var(--warning);transition:left 0.3s ease;z-index:-1}
        .submit-btn:hover{color:var(--primary)}
        .submit-btn:hover::before{left:0}
        .feedback-section{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:2rem;opacity:0;transform:translateY(20px);transition:all 0.5s ease}
        .feedback-section.show{opacity:1;transform:translateY(0)}
        .feedback-header{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem}
        .feedback-icon{font-size:1.5rem;width:40px;height:40px;border-radius:8px;display:flex;align-items:center;justify-content:center}
        .feedback-correct .feedback-icon{background:rgba(80,250,123,0.2);color:var(--success)}
        .feedback-incorrect .feedback-icon{background:rgba(255,85,85,0.2);color:var(--error)}
        .feedback-title{font-size:1.2rem;font-weight:600}
        .solution-steps{background:rgba(80,250,123,0.05);border:1px solid rgba(80,250,123,0.2);border-radius:12px;padding:1.5rem;margin-top:1.5rem}
        .solution-title{font-family:'JetBrains Mono',monospace;color:var(--success);font-size:0.9rem;margin-bottom:1rem}
        .solution-step{margin:0.8rem 0;padding:0.5rem 0;border-bottom:1px solid rgba(80,250,123,0.1)}
        .solution-step:last-child{border-bottom:none}
        .step-number{font-family:'JetBrains Mono',monospace;color:var(--success);font-size:0.8rem;margin-bottom:0.3rem}
        .step-content{font-size:1rem}
        .next-problem-btn{width:100%;background:var(--success);border:none;color:var(--primary);font-family:'JetBrains Mono',monospace;font-weight:500;font-size:1rem;padding:1rem 2rem;border-radius:8px;cursor:pointer;transition:all 0.3s ease;margin-top:1.5rem}
        .next-problem-btn:hover{background:var(--warning);transform:translateY(-2px)}
        @keyframes slideDown{from{transform:translateY(-50px);opacity:0}to{transform:translateY(0);opacity:1}}
        @keyframes slideUp{from{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}
        @media (max-width:768px){.container{padding:1rem}.main-content{grid-template-columns:1fr;gap:1.5rem}.header-controls{flex-direction:column;gap:0.5rem;align-items:flex-end}.breadcrumb{display:none}.equation-display{font-size:1.5rem}}
    </style>
</head>
<body>
    <div class="bg-container"><div class="grid-overlay"></div></div>
    <div class="container">
        <header>
            <a href="/math/algebra/quadratic-functions" class="logo">Lesson 4: Quadratic Formula</a>
            <div class="header-controls">
                <button class="restart-btn" onclick="restartLesson()">üîÑ Restart</button>
                <nav class="breadcrumb"><a href="/">home</a> / <a href="/math">math</a> / <a href="/math/algebra">algebra</a> / <a href="/math/algebra/quadratic-functions">quadratic functions</a> / <span>lesson 4</span></nav>
            </div>
        </header>
        <div class="main-content">
            <div class="problem-section">
                <div class="problem-header">
                    <div class="problem-number" id="problemNumber">Problem 1</div>
                    <h1 class="problem-title">Use Quadratic Formula</h1>
                </div>
                <div class="problem-statement">
                    <div class="equation-display" id="equationDisplay">x¬≤ + 3x - 4 = 0</div>
                    <p class="solve-instruction">Use x = (-b ¬± ‚àö(b¬≤ - 4ac)) / 2a</p>
                </div>
                <div class="input-section">
                    <label class="input-label" for="answerInput">Your solutions:</label>
                    <input type="text" id="answerInput" class="math-input" placeholder="x = ... or x = ..." autocomplete="off">
                </div>
                <button class="submit-btn" id="submitBtn">Check Answer</button>
            </div>
            <div class="feedback-section" id="feedbackSection">
                <div class="feedback-header">
                    <div class="feedback-icon" id="feedbackIcon">ü§î</div>
                    <h2 class="feedback-title" id="feedbackTitle">Submit your answer to see feedback</h2>
                </div>
                <div id="feedbackContent"></div>
            </div>
        </div>
    </div>
    <div class="score-panel" id="scorePanel" style="display:none">
        <div class="score-header"><span class="score-icon">üéØ</span><h3 class="score-title">// lesson score</h3></div>
        <div class="score-display"><span class="current-score" id="currentScore">0</span><span class="target-score">/ 100</span></div>
        <div class="progress-bar-container"><div class="progress-bar" id="progressBar"></div></div>
        <div class="progress-stats">
            <div class="stat-item"><span class="stat-value" id="currentStreak">0</span><span class="stat-label">streak</span></div>
            <div class="stat-item"><span class="stat-value" id="questionCount">0</span><span class="stat-label">questions</span></div>
        </div>
    </div>
    <div class="lesson-complete-modal" id="lessonCompleteModal" style="display:none">
        <div class="modal-content">
            <div class="modal-header"><div class="modal-icon">üèÜ</div><h2 class="modal-title">Lesson Complete!</h2><p class="modal-subtitle">You've mastered the quadratic formula!</p></div>
            <div class="modal-stats">
                <div class="final-score" id="finalScore">100</div><p>Excellent work on Lesson 4!</p>
                <div class="stat-grid">
                    <div class="stat-item"><span class="stat-value" id="finalAccuracy">100%</span><span class="stat-label">accuracy</span></div>
                    <div class="stat-item"><span class="stat-value" id="finalTime">5:30</span><span class="stat-label">time</span></div>
                </div>
            </div>
            <div id="achievementsContainer"></div>
            <div class="modal-actions">
                <a href="../" class="modal-btn">‚Üê Course Menu</a>
                <a href="../lesson5/" class="modal-btn primary">Next Lesson ‚Üí</a>
            </div>
        </div>
    </div>
    <script>
        function generateRandomProblem(){
            const v=getRandomVariable();
            const problemTypes=['twoSolutions','oneSolution','noRealSolutions'];
            const type=problemTypes[Math.floor(Math.random()*problemTypes.length)];
            let a,b,c,disc,r1,r2;
            if(type==='twoSolutions'){
                a=Math.floor(Math.random()*3)+1;
                b=Math.floor(Math.random()*10)-5;
                c=Math.floor(Math.random()*10)-5;
                disc=b*b-4*a*c;
                while(disc<0||!Number.isInteger(Math.sqrt(disc))){
                    b=Math.floor(Math.random()*10)-5;
                    c=Math.floor(Math.random()*10)-5;
                    disc=b*b-4*a*c;
                }
                r1=(-b+Math.sqrt(disc))/(2*a);
                r2=(-b-Math.sqrt(disc))/(2*a);
            }else if(type==='oneSolution'){
                a=Math.floor(Math.random()*3)+1;
                const k=Math.floor(Math.random()*5)+1;
                b=2*a*k;c=a*k*k;
                disc=0;r1=r2=-k;
            }else{
                a=Math.floor(Math.random()*3)+1;
                b=Math.floor(Math.random()*6)+1;
                c=Math.floor(Math.random()*10)+5;
                disc=b*b-4*a*c;
                while(disc>=0){c++;disc=b*b-4*a*c}
                r1=r2=null;
            }
            const aTerm=a===1?`${v}^2`:`${a}${v}^2`;
            const bTerm=b===0?'':(b===1?` + ${v}`:(b===-1?` - ${v}`:(b>0?` + ${b}${v}`:` - ${Math.abs(b)}${v}`)));
            const cTerm=c===0?'':(c>0?` + ${c}`:` - ${Math.abs(c)}`);
            const equation=`${aTerm}${bTerm}${cTerm} = 0`;
            const solutions=r1===null?null:[r1,r2].sort((x,y)=>x-y);
            return{
                equation,variable:v,solutions,a,b,c,disc,type,
                steps:[
                    {step:`Identify a=${a}, b=${b}, c=${c}`,equation:`a=${a}, b=${b}, c=${c}`},
                    {step:`Calculate discriminant: b¬≤ - 4ac = ${b}¬≤ - 4(${a})(${c}) = ${disc}`,equation:`Œî = ${disc}`},
                    {step:disc<0?'No real solutions (Œî < 0)':(disc===0?`One solution: x = -b/2a = ${r1}`:`Two solutions: x = (-${b} ¬± ‚àö${disc}) / ${2*a}`),equation:solutions?`${v} = ${solutions.join(', ')}`:'No real solutions'}
                ],
                mistakes:[
                    {type:"wrong_disc",description:"Wrong discriminant calculation",work:`Check: b¬≤ - 4ac = ${b}¬≤ - 4(${a})(${c})`},
                    {type:"forgot_neg_b",description:"Forgot negative sign on -b",work:"Formula starts with -b"},
                    {type:"divided_partial",description:"Divided only part of numerator",work:"Divide entire numerator by 2a"}
                ]
            };
        }
        function getRandomVariable(){return['x','y','t','n'][Math.floor(Math.random()*4)]}
        let currentProblem=null,problemCount=0,questionStartTime=Date.now();
        let attempts=0,problemAnswered=false,progressTracker=null;
        function initializeProgressTracking(){
            try{
                if(typeof ProgressTracker!=='undefined'){
                    progressTracker=new ProgressTracker();
                    progressTracker.initializeLesson('algebra_quadratics','quadratics_lesson4');
                    document.getElementById('scorePanel').style.display='block';
                }
            }catch(e){progressTracker=null}
        }
        function loadProblem(){
            currentProblem=generateRandomProblem();
            problemCount++;questionStartTime=Date.now();attempts=0;problemAnswered=false;
            document.getElementById('problemNumber').textContent=`Problem ${problemCount}`;
            if(progressTracker)document.getElementById('questionCount').textContent=problemCount;
            katex.render(currentProblem.equation,document.getElementById('equationDisplay'),{displayMode:true,throwOnError:false});
            document.getElementById('answerInput').value='';
            document.getElementById('answerInput').placeholder=currentProblem.type==='noRealSolutions'?'Type "no real solutions"':`${currentProblem.variable} = ... or ${currentProblem.variable} = ...`;
            const fs=document.getElementById('feedbackSection');
            fs.classList.remove('show','feedback-correct','feedback-incorrect');
            document.getElementById('feedbackIcon').textContent='ü§î';
            document.getElementById('feedbackTitle').textContent='Submit your answer to see feedback';
            document.getElementById('feedbackContent').innerHTML='';
            const sb=document.getElementById('submitBtn');
            sb.disabled=false;sb.textContent='Check Answer';
        }
        function parseAnswers(input){
            if(/no.*real|none|no solution/i.test(input))return'no_real';
            const m=input.match(/-?\d+\.?\d*/g);
            return m?m.map(n=>parseFloat(n)).sort((a,b)=>a-b):[];
        }
        function checkAnswer(){
            const input=document.getElementById('answerInput').value.trim();
            if(!input||problemAnswered)return;
            attempts++;
            const us=parseAnswers(input);
            let isCorrect=false;
            if(currentProblem.type==='noRealSolutions'){
                isCorrect=us==='no_real';
            }else{
                if(us==='no_real'||us.length!==2){alert('Please enter both solutions');return}
                const tol=0.1;
                isCorrect=Math.abs(us[0]-currentProblem.solutions[0])<tol&&Math.abs(us[1]-currentProblem.solutions[1])<tol;
            }
            problemAnswered=true;
            const sb=document.getElementById('submitBtn');
            sb.disabled=true;sb.textContent='Answered';
            if(progressTracker){
                const ts=Date.now()-questionStartTime;
                progressTracker.calculateScoreChange(isCorrect,ts,attempts);
                if(progressTracker.currentScore>=100)setTimeout(()=>showLessonComplete(),2000);
            }
            showFeedback(isCorrect,us);
        }
        function showFeedback(isCorrect,us){
            const fs=document.getElementById('feedbackSection');
            const fi=document.getElementById('feedbackIcon');
            const ft=document.getElementById('feedbackTitle');
            const fc=document.getElementById('feedbackContent');
            createCoinEffect(isCorrect);
            if(isCorrect){
                fs.className='feedback-section show feedback-correct';
                fi.textContent='üéâ';
                ft.textContent='Perfect! You used the formula correctly!';
                fc.innerHTML=`<div class="solution-steps"><div class="solution-title">// Correct Solution Steps</div>${currentProblem.steps.map((s,i)=>`<div class="solution-step"><div class="step-number">Step ${i+1}:</div><div class="step-content">${s.step}</div></div>`).join('')}</div><button class="next-problem-btn" onclick="nextProblem()">Next Problem ‚Üí</button>`;
            }else{
                fs.className='feedback-section show feedback-incorrect';
                fi.textContent='ü§Ø';
                ft.textContent='Not quite! Let\'s review the formula.';
                const yourAns=us==='no_real'?'No real solutions':`${currentProblem.variable} = ${us[0]}, ${us[1]}`;
                const correctAns=currentProblem.solutions?`${currentProblem.variable} = ${currentProblem.solutions[0].toFixed(2)}, ${currentProblem.solutions[1].toFixed(2)}`:'No real solutions';
                fc.innerHTML=`<div style="background:rgba(255,85,85,0.05);border:1px solid rgba(255,85,85,0.2);border-radius:12px;padding:1.5rem;margin:1.5rem 0"><p>You got: ${yourAns}</p><p>Correct: ${correctAns}</p><ul style="margin-top:1rem;color:var(--text-dim)"><li>Discriminant: Œî = b¬≤ - 4ac = ${currentProblem.disc}</li><li>If Œî < 0: no real solutions</li><li>If Œî = 0: one solution</li><li>If Œî > 0: two solutions</li></ul></div><div class="solution-steps"><div class="solution-title">// Correct Solution Steps</div>${currentProblem.steps.map((s,i)=>`<div class="solution-step"><div class="step-number">Step ${i+1}:</div><div class="step-content">${s.step}</div></div>`).join('')}</div><button class="next-problem-btn" onclick="nextProblem()">Try Another ‚Üí</button>`;
            }
        }
        function nextProblem(){loadProblem();setTimeout(()=>document.getElementById('answerInput').focus(),100)}
        function showLessonComplete(){
            if(!progressTracker)return;
            try{
                const m=document.getElementById('lessonCompleteModal');
                const ld=progressTracker.completeLessonAttempt();
                document.getElementById('finalScore').textContent=ld.score;
                document.getElementById('finalAccuracy').textContent=Math.round(ld.accuracy*100)+'%';
                document.getElementById('finalTime').textContent=formatTime(ld.timeSpent);
                m.classList.add('show');
            }catch(e){console.error(e)}
        }
        function restartLesson(){
            if(confirm('Restart lesson?')){
                problemCount=0;attempts=0;problemAnswered=false;
                if(progressTracker){progressTracker.currentScore=0;progressTracker.streak=0;progressTracker.questionCount=0;progressTracker.updateScoreDisplay()}
                loadProblem();alert('Lesson restarted! üéØ');
            }
        }
        function formatTime(ms){const s=Math.floor(ms/1000),m=Math.floor(s/60);return`${m}:${(s%60).toString().padStart(2,'0')}`}
        function createCoinEffect(isCorrect){
            const b=document.getElementById('submitBtn'),r=b.getBoundingClientRect();
            const cx=r.left+r.width/2,cy=r.top+r.height/2;
            for(let i=0;i<(isCorrect?8:4);i++)setTimeout(()=>createCoin(cx,cy,isCorrect?'ü™ô':'üíî',isCorrect),i*50);
        }
        function createCoin(x,y,symbol,isCorrect){
            const c=document.createElement('div');
            const a=Math.PI*2*Math.random(),d=80+Math.random()*40;
            const ex=x+Math.cos(a)*d,ey=y+Math.sin(a)*d-30;
            c.style.cssText=`position:fixed;left:${x}px;top:${y}px;font-size:1.2rem;pointer-events:none;z-index:2000;animation:${isCorrect?'coinSuccess':'coinFail'} 1s ease-out forwards;--endX:${ex}px;--endY:${ey}px`;
            c.textContent=symbol;
            if(!document.querySelector('style[data-coin-animation]')){
                const s=document.createElement('style');
                s.setAttribute('data-coin-animation','true');
                s.textContent=`@keyframes coinSuccess{0%{transform:scale(0) rotate(0deg);opacity:1}20%{transform:scale(1.2) rotate(90deg);opacity:1}100%{transform:scale(0.8) rotate(360deg) translate(calc(var(--endX) - ${x}px),calc(var(--endY) - ${y}px));opacity:0}}@keyframes coinFail{0%{transform:scale(0) rotate(0deg);opacity:1}20%{transform:scale(1) rotate(-30deg);opacity:1}100%{transform:scale(0.5) rotate(-180deg) translate(calc(var(--endX) - ${x}px),calc(var(--endY) - ${y}px));opacity:0}}`;
                document.head.appendChild(s);
            }
            document.body.appendChild(c);
            setTimeout(()=>c.remove(),1000);
        }
        document.getElementById('submitBtn').addEventListener('click',checkAnswer);
        document.getElementById('answerInput').addEventListener('keypress',e=>{if(e.key==='Enter')checkAnswer()});
        window.addEventListener('load',()=>{initializeProgressTracking();loadProblem()});
    </script>
</body>
</html>
